<!DOCTYPE html>
<html>
<head>
<title>Update Harga Pangan</title>
<style>
body{font-family:Arial;background:#f4f4f4;padding:20px}
.box{background:#fff;padding:20px;border-radius:10px;max-width:600px;margin:auto}
input,select,textarea,button{width:100%;padding:10px;margin-top:8px}
button{background:#28a745;color:#fff;border:none;font-weight:bold}
</style>
</head>
<body>

<div class="box">
<h3>Update Harga Sistem Informasi Pangan</h3>

<form id="form">

<label>SURVEYOR</label>
<input type="text" name="surveyor" required>

<label>PILIH KOMODITAS</label>
<select name="komoditas" required>
<option value="">-- Pilih --</option>
<option>Bawang Merah ( Kg )</option>
<option>Minyak Goreng Kemasan</option>
<option>Beras</option>
<option>Telur</option>
<option>Ayam</option>
</select>

<label>KUALITAS</label><br>
<input type="radio" name="kualitas" value="Premium" required> Premium<br>
<input type="radio" name="kualitas" value="Medium"> Medium<br>
<input type="radio" name="kualitas" value="Rendah"> Rendah<br>

<label>HARGA (Rupiah)</label>
<input type="number" name="harga" required>

<label>CATATAN</label>
<textarea name="catatan"></textarea>

<label>DOKUMENTASI</label>
<input type="file" name="foto" accept="image/*" required>

<button type="submit">KIRIM</button>
</form>

<p id="status"></p>
</div>

<iframe name="hidden_iframe" style="display:none;"></iframe>

<script>
const API = "https://script.google.com/macros/s/AKfycbwWFZWiu4VGX5oiXf3QWr1Jt0CBMc9MJeHUCgUs4PdiQ4e8zVQBhi1GtL_rS6pYBQUeEA/exec";

const form = document.getElementById("form");
const status = document.getElementById("status");

form.addEventListener("submit", function(e){
e.preventDefault();
status.innerHTML="⏳ Mengirim data...";

const file = form.foto.files[0];
const reader = new FileReader();

reader.onload = function(){

const payload = {
surveyor: form.surveyor.value,
komoditas: form.komoditas.value,
kualitas: document.querySelector('input[name="kualitas"]:checked').value,
harga: form.harga.value,
catatan: form.catatan.value,
file: reader.result.split(",")[1],
filename: file.name
};

// buat form sementara
const f = document.createElement("form");
f.method="POST";
f.action=API;
f.target="hidden_iframe";

const input = document.createElement("input");
input.type="hidden";
input.name="data";
input.value=JSON.stringify(payload);

f.appendChild(input);
document.body.appendChild(f);
f.submit();
f.remove();

status.innerHTML="✅ Data berhasil dikirim";
form.reset();
}

reader.readAsDataURL(file);
});
</script>

</body>
</html>
